---
import BaseLayout from "../layouts/BaseLayout.astro";
import PostCard from "../components/PostCard.astro";
import { getCollection } from "astro:content";

const posts = (await getCollection("posts", ({ data }) => !data.draft))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 5);
---

<BaseLayout title="CyberDan - Blog">
  <section class="mb-12">
    <h1 class="text-4xl font-bold text-(--color-text) sm:text-5xl">
      Hey, I'm Daniel
    </h1>
    <p class="mt-4 text-lg text-(--color-text-secondary)">
      I write about DevOps, programming, and web development. Welcome to my corner of the internet.
    </p>
    <div class="mt-6 flex gap-4">
      <a
        href="/posts"
        class="inline-flex items-center rounded-lg bg-(--color-accent) px-5 py-2.5 text-sm font-medium text-white hover:bg-(--color-accent-hover) transition-colors"
      >
        Read posts
      </a>
      <a
        href="/about"
        class="inline-flex items-center rounded-lg border border-(--color-border) px-5 py-2.5 text-sm font-medium text-(--color-text) hover:bg-(--color-bg-secondary) transition-colors"
      >
        About me
      </a>
    </div>
  </section>

  {posts.length > 0 && (
    <section>
      <h2 class="mb-6 text-2xl font-bold text-(--color-text)">Recent Posts</h2>
      <div class="flex flex-col gap-4">
        {posts.map((post) => (
          <PostCard
            title={post.data.title}
            description={post.data.description}
            pubDate={post.data.pubDate}
            tags={post.data.tags}
            slug={post.id}
          />
        ))}
      </div>
    </section>
  )}
</BaseLayout>
