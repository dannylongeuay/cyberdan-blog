---
import ThemeToggle from "./ThemeToggle.astro";

const pathname = Astro.url.pathname;

const navLinks = [
  { href: "/", label: "Home" },
  { href: "/blog", label: "Blog" },
  { href: "/about", label: "About" },
  { href: "/tags", label: "Tags" },
];

function isActive(href: string) {
  if (href === "/") return pathname === "/";
  return pathname.startsWith(href);
}
---

<header class="border-b border-(--color-border) sticky top-0 z-50 bg-(--color-bg)/95 backdrop-blur-sm">
  <div class="mx-auto max-w-3xl px-4 flex items-center justify-between h-16">
    <a href="/" class="text-xl font-bold text-(--color-text) hover:text-(--color-accent) transition-colors">
      CyberDan
    </a>

    <nav class="hidden sm:flex items-center gap-6">
      {navLinks.map(({ href, label }) => (
        <a
          href={href}
          class:list={[
            "text-sm font-medium transition-colors",
            isActive(href)
              ? "text-(--color-accent)"
              : "text-(--color-text-secondary) hover:text-(--color-text)",
          ]}
        >
          {label}
        </a>
      ))}
      <ThemeToggle />
    </nav>

    <div class="flex items-center gap-2 sm:hidden">
      <ThemeToggle />
      <button
        id="mobile-menu-toggle"
        type="button"
        aria-label="Toggle menu"
        class="rounded-lg p-2 text-(--color-text-secondary) hover:text-(--color-text) hover:bg-(--color-bg-secondary) transition-colors"
      >
        <svg id="menu-open-icon" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
        <svg id="menu-close-icon" class="hidden h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>

  <div id="mobile-menu" class="hidden sm:hidden border-t border-(--color-border)">
    <nav class="mx-auto max-w-3xl px-4 py-4 flex flex-col gap-3">
      {navLinks.map(({ href, label }) => (
        <a
          href={href}
          class:list={[
            "text-sm font-medium transition-colors",
            isActive(href)
              ? "text-(--color-accent)"
              : "text-(--color-text-secondary) hover:text-(--color-text)",
          ]}
        >
          {label}
        </a>
      ))}
    </nav>
  </div>
</header>

<script is:inline>
  document.getElementById('mobile-menu-toggle').addEventListener('click', () => {
    const menu = document.getElementById('mobile-menu');
    const openIcon = document.getElementById('menu-open-icon');
    const closeIcon = document.getElementById('menu-close-icon');
    const isHidden = menu.classList.toggle('hidden');
    openIcon.classList.toggle('hidden', !isHidden);
    closeIcon.classList.toggle('hidden', isHidden);
  });
</script>
